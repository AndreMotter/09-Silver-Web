<div style="margin-top: 20px;"></div>
<p-fieldset icon="pi pi-pencil" legend="Gerenciamento de Categorias">
  <div class="grid">
    <div class="col-12">
      <span class="p-input-icon-left">
        <i class="pi pi-search"></i>
        <input type="text" placeholder="Sigla" (keydown.enter)="listarCategorias()" pInputText
          [(ngModel)]="cat_sigla" />
      </span>
    </div>
  </div>
  <div class="grid">
    <div class="col-12 flex justify-content-end">
      <button pButton type="button" label="Adicionar Categoria" icon="pi pi-plus" (click)="abrirModal()"></button>
    </div>
  </div>

  <div class="card">
    <p-table [value]="categorias">
      <ng-template pTemplate="header">
        <tr>
          <th>Código</th>
          <th>Sigla</th>
          <th>Descrição</th>
          <th>Tipo</th>
          <th>Ações</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-categoria>
        <tr>
          <td style="width: 10%;">{{ categoria.cat_codigo }}</td>
          <td style="width: 20%;">{{ categoria.cat_sigla }}</td>
          <td style="width: 30%;">{{ categoria.cat_descricao }}</td>
          <td style="width: 20%;">{{ categoria.cat_tipo == 0 ? 'Despesa' : 'Receita' }}</td>
          <td style="width: 20%;">
            <button pButton type="button" icon="pi pi-pencil" label="Editar"
              class="p-button-rounded p-button-success p-mr-3" (click)="editar(categoria.cat_codigo)"></button>
            <button style="margin-left: 10px;" pButton type="button" icon="pi pi-trash" label="Excluir"
              class="p-button-rounded p-button-danger" (click)="excluir(categoria.cat_codigo)"></button>
          </td>
        </tr>
      </ng-template>
    </p-table>
    <div class="card flex justify-content-left">
      <p-paginator (onPageChange)="onPageChange($event)" [first]="first" [rows]="rows" [totalRecords]="120" [rowsPerPageOptions]="[10, 20, 50, 100]"></p-paginator>
    </div>
  </div>
</p-fieldset>

<p-dialog header="Incluir/Alterar Categoria" [(visible)]="displayModal" [modal]="true" [responsive]="true"
  [style]="{width: '50vw'}">
  <form #pessoaForm="ngForm">
    <div class="p-fluid">
      <div class="p-field">
        <label for="nome">Sigla</label>
        <input type="text" id="nome" pInputText [(ngModel)]="categoria.cat_sigla" name="nome" required />
      </div>
      <div class="p-field">
        <label for="login">Descrição</label>
        <input type="text" id="login" pInputText [(ngModel)]="categoria.cat_descricao" name="login" required />
      </div>
      <div class="p-field">
        <p-dropdown [options]="tiposCategorias" [(ngModel)]="categoria.cat_tipo" placeholder="Tipo Categoria"
          optionLabel="name"></p-dropdown>
      </div>
    </div>
    <p-footer>
      <button type="button" pButton label="Salvar" icon="pi pi-check" (click)="salvar()"></button>
    </p-footer>
  </form>
</p-dialog>